# テザリング通信量監視アプリ

Windows 11上でテザリング中のアプリ通信量を監視するアプリケーション

## 📁 ファイル構成

### メインファイル
- **【最終版】完璧な起動_管理者.vbs** - メイン起動ファイル（推奨）
- **【最終版】完璧な起動.vbs** - 通常版（管理者権限なし）
- **network_monitor_v2.py** - メインプログラム
- **install.bat** - 依存関係インストール
- **requirements.txt** - 必要なパッケージリスト

### 調査ツール
- **Chrome通信調査.bat** - Chrome通信の詳細分析
- **大容量通信調査_修正版.bat** - 大容量通信の特定（5分間監視）
- **長時間通信調査.bat** - 長時間監視（30分間）
- **タスクマネージャー活用ガイド.bat** - タスクマネージャーとの連携方法

### ドキュメント
- **README.md** - このファイル

## 🚀 クイックスタート

### 1. 初回セットアップ
```cmd
install.bat
```

### 2. アプリ起動
**【最終版】完璧な起動_管理者.vbs** をダブルクリック
- UAC確認で「はい」をクリック
- GUIウィンドウがタスクバーに表示
- プロンプト画面は一切表示されない

### 3. 監視開始
1. GUIで「Start Monitoring」をクリック
2. 監視間隔を選択（30秒/1分/3分/5分）
3. 監視開始

## 📊 主な機能

### メイン機能
- **リアルタイム監視**: 選択した間隔（30秒〜5分）で通信量をチェック
- **プロセスごとの表示**: 各アプリの推定通信量を表示
- **累積データ**: アプリごとの累積通信量を記録
- **サイレントモード**: ポップアップメッセージを抑制
- **データ保存**: JSON形式でエクスポート

### 特徴
- ✅ プロンプト画面が一切表示されない
- ✅ 更新時のチラつきゼロ
- ✅ 最小化してもタスクバーに残る
- ✅ 管理者権限で全プロセス監視

## 🔧 システム要件

- Windows 11
- Python 3.8以上
- 管理者権限（推奨）

## 📖 使用方法

### 基本的な使い方

#### 日常監視
```
1. 【最終版】完璧な起動_管理者.vbs をダブルクリック
2. 「Start Monitoring」をクリック
3. 監視間隔を選択（推奨: 1分）
4. 最小化して作業継続
5. 必要時にタスクバーから復元
```

#### データ確認
```
1. タスクバーのアイコンをクリックでGUI表示
2. 通信量ランキングを確認
3. 「Save Data」でエクスポート
4. 再度最小化
```

### 調査ツールの使い方

#### Chrome通信調査
```
Chrome通信調査.bat を実行
→ Chromeの詳細な通信情報を表示
→ プロセスタイプ・接続先を確認
```

#### 大容量通信調査
```
大容量通信調査_修正版.bat を実行
→ 5分間監視して10MB以上の通信を検出
→ 疑わしいプロセスを特定
```

#### 長時間通信調査
```
長時間通信調査.bat を実行
→ 30分間監視して50MB以上の通信を検出
→ 時間帯別の通信量を分析
```

## 💡 監視間隔の選び方

| 間隔 | CPU負荷 | 精度 | 推奨用途 |
|------|---------|------|----------|
| 30秒 | 中 | 高 | リアルタイム分析 |
| **1分** | 低 | 高 | **日常使用（推奨）** |
| 3分 | 極小 | 中 | 軽量モード |
| 5分 | 最小 | 中 | バッテリー節約 |

## 🔍 データの見方

### メイン画面の表示項目

- **Rank**: 通信量ランキング
- **PID**: プロセスID
- **App Name**: アプリケーション名
- **Sent**: 送信データ量
- **Received**: 受信データ量
- **Total**: 合計データ量
- **Connections**: 接続数
- **Last Update**: 最終更新時刻

### 通信量の推定方法

このアプリは接続数に基づいて通信量を推定します：
- システム全体の通信量を測定
- 各プロセスの接続数をカウント
- 接続数の比率で通信量を配分

**注意**: 推定値であり、正確な測定ではありません。

## 📋 よくある質問

### Q: 最小化したらタスクバーから消える
A: 【最終版】完璧な起動_管理者.vbs を使用してください。最小化してもタスクバーに残ります。

### Q: 更新時にプロンプトがチラつく
A: network_monitor_v2.pyが修正済みです。チラつきは発生しません。

### Q: 管理者権限は必要？
A: 推奨です。一部のシステムプロセスは管理者権限がないと監視できません。

### Q: タスクマネージャーとの違いは？
A: 
- タスクマネージャー: 長期傾向（30日間）
- このアプリ: リアルタイム監視（カスタマイズ可能）
- 両方を組み合わせるのが最適

## ⚙️ トラブルシューティング

### 起動しない
```
1. Pythonがインストールされているか確認
2. install.bat を実行
3. エラーログ（launch_error.log）を確認
```

### プロセスが表示されない
```
1. 管理者権限で起動しているか確認
2. 監視を開始しているか確認
3. 数分待ってデータが更新されるか確認
```

### 通信量が表示されない
```
1. インターネット接続を確認
2. 他のアプリが通信しているか確認
3. 監視間隔を短く設定（1分に変更）
```

## 🎯 推奨ワークフロー

### 日常使用
```
朝: 【最終版】完璧な起動_管理者.vbs で起動
  → 監視開始
  → 最小化

日中: 通常作業
  → バックグラウンドで監視継続

気になった時: タスクバーから復元
  → データ確認
  → 必要に応じて調査ツール実行

夜: データ保存
  → アプリ終了
```

### 問題調査
```
1. タスクマネージャーで長期傾向を確認
2. このアプリで現在の通信状況を確認
3. 異常があれば調査ツール実行:
   - Chrome問題 → Chrome通信調査.bat
   - 大容量通信 → 大容量通信調査_修正版.bat
   - 長期分析 → 長時間通信調査.bat
4. 対策実施
```

## 📝 バージョン履歴

### v2.0 (最終版)
- 更新時のチラつき完全解消
- タスクバー常駐機能追加
- 不要ファイル整理
- 完璧な動作を実現

### v1.0
- 初回リリース
- 基本的な監視機能

## 📄 ライセンス

このアプリケーションはMITライセンスの下で提供されています。

## 🙏 サポート

問題が発生した場合は、以下の情報を含めてお問い合わせください：
- Windows 11のバージョン
- Pythonのバージョン
- エラーメッセージ
- 実行環境の詳細