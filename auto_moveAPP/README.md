# ダウンロードフォルダ自動振り分けアプリ

## 📋 概要

ダウンロードフォルダに新しいファイルが追加された際、ファイル名に基づいて自動的に適切なフォルダに振り分ける省メモリ・小負荷のアプリケーションです。

## ✨ 特徴

- **省メモリ**: 通常10-20MB程度のメモリ使用量
- **小負荷**: Windowsファイルシステムイベントベースの効率的な監視
- **ポータブル**: インストール不要でUSBメモリなどから実行可能
- **柔軟な設定**: JSONファイルで振り分けルールをカスタマイズ可能
- **スタートアップ対応**: PC起動時に自動開始可能

## 🚀 使用方法

### 1. 初回セットアップ

1. `start_file_mover.bat` をダブルクリックして実行
2. 初回実行時に必要なライブラリが自動インストールされます
3. 設定ファイル `config.json` が自動作成されます

### 2. スタートアップ登録（オプション）

PC起動時に自動的にアプリを開始したい場合：

1. `install_to_startup.bat` を右クリック
2. 「管理者として実行」を選択
3. スタートアップ登録が完了します

### 3. アプリケーション停止

- 実行中に `Ctrl+C` を押す
- または `stop_file_mover.bat` を実行

## ⚙️ 設定方法

`config.json` ファイルを編集して振り分けルールをカスタマイズできます：

```json
{
  "watch_folder": "C:/Users/ユーザー名/Downloads",
  "rules": [
    {
      "name": "PDFファイル",
      "pattern": ".*\\.pdf$",
      "destination": "Documents/PDF",
      "action": "move"
    }
  ],
  "log_level": "INFO",
  "delay_seconds": 3,
  "create_directories": true
}
```

### 設定項目説明

- **watch_folder**: 監視するフォルダのパス
- **rules**: 振り分けルールの配列
  - **name**: ルール名
  - **pattern**: ファイル名にマッチする正規表現
  - **destination**: 移動先フォルダ（ホームディレクトリからの相対パス）
  - **action**: "move"（移動）または"copy"（コピー）
- **log_level**: ログレベル（DEBUG, INFO, WARNING, ERROR）
- **delay_seconds**: ファイル処理までの待機時間（秒）
- **create_directories**: 移動先フォルダの自動作成

## 📁 デフォルト振り分けルール

- **PDFファイル** → `Documents/PDF/`
- **画像ファイル** → `Pictures/Downloads/`
- **動画ファイル** → `Videos/Downloads/`
- **音楽ファイル** → `Music/Downloads/`
- **実行ファイル** → `Programs/`
- **圧縮ファイル** → `Downloads/Archives/`
- **ドキュメント** → `Documents/Downloads/`
- **その他** → `Downloads/Others/`

## 📝 ログファイル

アプリケーションの動作状況は `file_mover.log` ファイルに記録されます。

## 🔧 必要な環境

- Windows 10/11
- Python 3.7以上
- watchdog ライブラリ（初回実行時に自動インストール）

## 📊 パフォーマンス

- **メモリ使用量**: 約10-20MB
- **CPU使用率**: 通常時はほぼ0%、ファイル処理時のみ一時的に上昇
- **ディスク使用量**: 約5MB（アプリケーション本体）

## ⚠️ 注意事項

1. 同名ファイルが移動先に存在する場合、自動的に番号を付けて保存されます
2. ファイルの移動は元のファイルを削除します（コピーではありません）
3. 設定ファイルを変更した場合は、アプリケーションを再起動してください
4. 管理者権限はスタートアップ登録時のみ必要です

## 🛠️ トラブルシューティング

### アプリが起動しない
- Pythonがインストールされているか確認
- `start_file_mover.bat` を管理者権限で実行

### ファイルが移動されない
- ログファイル `file_mover.log` を確認
- 設定ファイルのパスが正しいか確認
- 移動先フォルダの書き込み権限を確認

### スタートアップ登録ができない
- `install_to_startup.bat` を管理者権限で実行
- ウイルス対策ソフトがブロックしていないか確認

## 📞 サポート

問題が発生した場合は、ログファイルの内容とエラーメッセージを確認してください。
