# ダウンロードフォルダ自動振り分けアプリ

## 📋 概要

ダウンロードフォルダに新しいファイルが追加された際、ファイル名に基づいて自動的に適切なフォルダに振り分ける省メモリ・小負荷のアプリケーションです。

## ✨ 特徴

- **省メモリ**: 通常10-20MB程度のメモリ使用量
- **小負荷**: Windowsファイルシステムイベントベースの効率的な監視
- **ポータブル**: インストール不要でUSBメモリなどから実行可能
- **バックグラウンド動作**: システムトレイに最小化して常時監視
- **スタートアップ対応**: PC起動時に自動開始可能
- **安全な移動**: コピー→整合性確認→削除の安全な手順
- **GUI設定**: 直感的な設定画面でルール管理

## 🚀 使用方法

### 1. 初回起動

```
dist/ダウンロード自動振り分け.exe をダブルクリック
```

### 2. 基本設定

1. **監視開始**
   - 「監視開始」ボタンをクリック
   - ダウンロードフォルダの監視が開始されます

2. **設定変更**
   - 「設定」ボタンをクリック
   - 監視フォルダや振り分けルールを設定
   - 「保存」ボタンで設定を保存

3. **トレイに最小化**
   - 「トレイに最小化」ボタンをクリック
   - システムトレイに最小化され、バックグラウンドで動作継続

### 3. システムトレイからの操作

#### **トレイアイコンの操作**
- **左クリック**: メインウィンドウを表示
- **右クリック**: メニューを表示

#### **トレイメニュー**
- **表示**: メインウィンドウを表示
- **監視開始**: トレイから監視開始
- **監視停止**: トレイから監視停止
- **終了**: アプリケーション完全終了

### 4. スタートアップ登録（オプション）

#### **登録方法**
1. 「スタートアップ設定」ボタンをクリック
2. 「スタートアップ登録」ボタンをクリック
3. 管理者権限で実行

#### **スタートアップ時の動作**
- PC起動時に自動的に起動
- システムトレイに最小化で起動
- 自動的に監視開始
- バックグラウンドで動作継続

## ⚙️ 設定方法

### 振り分けルールの設定

#### **デフォルトルール**
- **PDFファイル** → `Documents/PDF/`
- **画像ファイル** → `Pictures/Downloads/`
- **動画ファイル** → `Videos/Downloads/`
- **音楽ファイル** → `Music/Downloads/`
- **実行ファイル** → `Programs/`
- **圧縮ファイル** → `Downloads/Archives/`
- **ドキュメント** → `Documents/Downloads/`
- **その他** → `Downloads/Others/`

#### **カスタムルールの追加**
1. 設定画面で「追加」ボタンをクリック
2. ルール名、パターン、移動先、アクションを設定
3. 「OK」ボタンで保存

#### **ルールの編集・削除**
1. 設定画面でルールを選択
2. 「編集」または「削除」ボタンをクリック
3. 変更を保存

### パターン設定

#### **正規表現の例**
- `.*\.pdf$` - PDFファイル
- `.*\.(jpg|jpeg|png)$` - 画像ファイル
- `.*kaunet_.*` - kaunetを含むファイル
- `.*2024.*` - 2024を含むファイル

#### **移動先設定**
- **絶対パス**: `C:/LocalApp/kaunetAPP/DATA`
- **相対パス**: `Documents/PDF`（ホームディレクトリ基準）

## 📁 ファイル構成

```
auto_moveAPP/
├── dist/
│   ├── ダウンロード自動振り分け.exe  ← メインアプリケーション
│   ├── config.json                   ← 設定ファイル
│   └── file_mover.log                ← ログファイル（自動生成）
├── file_mover_gui.py                 ← ソースコード
├── config.json                       ← デフォルト設定ファイル
├── requirements_gui.txt              ← 必要ライブラリ
└── README.md                         ← このファイル
```

## 🔧 必要な環境

### 実行環境
- **Windows 10/11**
- **.NET Framework**（通常Windowsに標準搭載）

### 開発環境（ソースコード編集時）
- **Python 3.7以上**
- **watchdog** ライブラリ
- **pystray** ライブラリ
- **Pillow** ライブラリ

## 📊 パフォーマンス

- **メモリ使用量**: 約10-20MB
- **CPU使用率**: 通常時はほぼ0%、ファイル処理時のみ一時的に上昇
- **ディスク使用量**: 約5MB（アプリケーション本体）

## 🛡️ 安全機能

### 安全なファイル移動
1. **コピー実行** - ファイルをコピー
2. **整合性確認** - ファイルサイズとハッシュ値を確認
3. **元ファイル削除** - 確認が完了してから元ファイルを削除
4. **エラー時クリーンアップ** - 問題発生時はコピー先を自動削除

### エラー処理
- **詳細なログ記録** - 全ての処理をログファイルに記録
- **例外処理** - エラー発生時の適切な処理
- **自動復旧** - 一時的なエラーからの自動復旧

## ⚠️ 注意事項

1. **同名ファイル**: 移動先に同名ファイルが存在する場合、自動的に番号を付けて保存
2. **ファイル移動**: ファイルの移動は元のファイルを削除します（コピーではありません）
3. **権限**: スタートアップ登録時のみ管理者権限が必要
4. **設定変更**: 設定ファイルを変更した場合は、アプリケーションを再起動
5. **ネットワークドライブ**: ネットワークドライブ間の移動で問題が発生する可能性

## 🛠️ トラブルシューティング

### アプリが起動しない
- Windows Defenderがブロックしていないか確認
- ウイルス対策ソフトがブロックしていないか確認
- 必要な権限があるか確認

### ファイルが移動されない
- ログファイル `file_mover.log` を確認
- 設定ファイルのパスが正しいか確認
- 移動先フォルダの書き込み権限を確認

### スタートアップ登録ができない
- 管理者権限で実行しているか確認
- ウイルス対策ソフトがブロックしていないか確認

### トレイアイコンが表示されない
- タスクトレイの設定を確認
- アイコンが隠れていないか確認
- アプリケーションを再起動

## 📞 サポート

問題が発生した場合は、以下を確認してください：

1. **ログファイル** - `file_mover.log` の内容を確認
2. **設定ファイル** - `config.json` の設定を確認
3. **エラーメッセージ** - 表示されるエラーメッセージを確認

## 📝 更新履歴

### v5.0（最終版）
- システムトレイ対応
- バックグラウンド動作
- スタートアップ最小化起動
- 安全なファイル移動
- GUI設定画面
- 完全終了処理の修正

---

**ダウンロードフォルダ自動振り分けアプリ v5.0**  
省メモリ・小負荷でダウンロードされたファイルを自動的に振り分けます